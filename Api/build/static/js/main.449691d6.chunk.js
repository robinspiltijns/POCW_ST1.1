(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{104:function(t,e,a){},122:function(t,e,a){},126:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a.n(n),s=a(52),o=a.n(s),r=a(3),l=a(4),c=a(6),h=a(5),u=a(7),m=a(10),v=a(24),d=a.n(v),f=a(53),w=a(1),g=a(9),b=a.n(g),p=a(18),y=a.n(p),C=a(54),D=a.n(C),k=new Date,O="",M=!1,E=window.innerWidth,S=window.innerHeight,T=Math.atan2(S,E),j=Math.atan2(S,-E),I=Math.atan2(-S,-E)+2*Math.PI,P=Math.atan2(-S,E)+2*Math.PI,A=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(h.a)(e).call(this))).slaveChannel=b()("/slaveChannel"),t.state={tricolor:"",color:"",canvasDataToDisplay:"",canvasWidth:"",canvasHeight:"",animationInfo:"",browserDimensions:[window.innerWidth,window.innerHeight],id:D.a.load("token"),isCounting:!1,seconds:10,timeDiff:0},t.canvas=i.a.createRef(),t.count=t.count.bind(Object(w.a)(t)),t.init=t.init.bind(Object(w.a)(t)),t.draw=t.draw.bind(Object(w.a)(t)),t}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;console.log("my state:  "+JSON.stringify(this.state)),this.slaveChannel.emit("slaveJoin",this.state),this.slaveChannel.on("setState",(function(e){console.log(JSON.stringify(e)),t.setState(e)})),this.slaveChannel.on("animationInfo",(function(e){t.setState({animationInfo:e}),t.init()})),this.slaveChannel.on("initialiseCountdown",(function(e){var a=(new Date).getTime();t.slaveChannel.emit("timeData",{id:t.state.id,t1:e,t2:a,t3:(new Date).getTime()})})),this.slaveChannel.on("startCountdown",(function(){t.state.isCounting||(console.log("going green"),t.setState({isCounting:!0,tricolor:"green",color:"green"}),console.log("timeOut: "),console.log(t.state.timeToStart),console.log(t.state.timeDiff),console.log(-(new Date).getTime()),console.log(t.state.timeToStart+t.state.timeDiff-(new Date).getTime()),setTimeout((function(){t.count(),console.log("going yellow"),t.setState({color:"yellow",tricolor:"yellow"})}),t.state.timeToStart+t.state.timeDiff-(new Date).getTime()))})),this.slaveChannel.on("requestSlaves",(function(){t.slaveChannel.emit("slaveJoin",t.state)})),this.slaveChannel.on("setCanvas",(function(e,a,n){t.setState({canvasDataToDisplay:e,canvasWidth:a,canvasHeight:n})}))}},{key:"timeout",value:function(t){return new Promise((function(e){return setTimeout(e,t)}))}},{key:"count",value:function(){var t=Object(f.a)(d.a.mark((function t(){var e,a=this;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.state.seconds;case 1:if(!(e>0)){t.next=8;break}return t.next=4,this.timeout(1e3);case 4:this.setState({seconds:this.state.seconds-1});case 5:e--,t.next=1;break;case 8:this.setState({color:"blue",tricolor:"blue"}),setTimeout((function(){a.setState({seconds:10,isCounting:!1})}),1e3),this.slaveChannel.emit("finishCountdown");case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){this.drawCanvas()}},{key:"init",value:function(){if(this.state.animationInfo){var t=this.state.animationInfo,e=t.toDir,a=t.fromDir;if(""!==e&&""!==a&&(M=!0),""===e&&""===a)return;if(""===a&&!M)return O="startPoint",k=new Date,void window.requestAnimationFrame(this.draw);if(""===e&&!M)return O="endPoint",k=new Date,void window.requestAnimationFrame(this.draw);if(M)return O="endPoint",k=new Date,void window.requestAnimationFrame(this.draw)}}},{key:"draw",value:function(){var t=this.state.browserDimensions[1],e=this.state.browserDimensions[0],a=!0,n=this.canvas.current.getContext("2d"),i=this.state.animationInfo,s=i.toDir,o=i.fromDir,r=i.velocity,l=0,c=0,h=k,u=new Date,m=u.getSeconds()-h.getSeconds(),v=u.getMilliseconds()-h.getMilliseconds();if("startPoint"===O){var d=r*m+r/1e3*v;if(l=Math.cos(s)*d+e/2,c=Math.sin(s)*d+t/2,(s<T&&s>=0||s>P&&s<2*Math.PI)&&(a=l-30>=e),s>=T&&s<j&&(a=c-30>=t),s>=j&&s<I&&(a=l+30<=0),s>=I&&s<=P&&(a=c+30<=0),a)return console.log("cut off"),void n.clearRect(0,0,e,t)}if("endPoint"===O){var f=0;(o<T&&o>=0||o>P&&o<2*Math.PI)&&(f=Math.sqrt(e*e/4+Math.tan(o)*e/2*Math.tan(o)*e/2)+30),o>=T&&o<j&&(f=Math.sqrt(t*t/4+1/Math.tan(o)*t/2*(1/Math.tan(o))*t/2)+30),o>=j&&o<I&&(f=Math.sqrt(e*e/4+Math.tan(o)*e/2*Math.tan(o)*e/2)+30),o>=I&&o<=P&&(f=Math.sqrt(t*t/4+1/Math.tan(o)*t/2*(1/Math.tan(o))*t/2)+30);var w=f-r*m-r/1e3*v;if(w<=1)return console.log("reached Midpoint"),void(M&&(O="startPoint",k=new Date,window.requestAnimationFrame(this.draw)));l=Math.cos(o)*w+e/2,c=Math.sin(o)*w+t/2}n.clearRect(0,0,e,t),n.beginPath(),n.arc(l,c,30,0,2*Math.PI),n.stroke(),window.requestAnimationFrame(this.draw)}},{key:"drawCanvas",value:function(){var t=this.state.browserDimensions[1],e=this.state.browserDimensions[0],a=this.canvas.current,n=this.state.tricolor,i=this.state.canvasDataToDisplay,s=a.getContext("2d");this.state.animationInfo;if(s.clearRect(0,0,e,t),n&&(s.beginPath(),s.fillStyle=n,s.moveTo(0,0),s.lineTo(e,0),s.lineTo(0,t),s.fill(),s.closePath()),i){var o=this.state.canvasWidth,r=this.state.canvasHeight,l=new Image;l.onload=function(){s.drawImage(l,0,0,o,r,0,0,e,t)},l.src=i}}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(p.Helmet,null,i.a.createElement("style",null,"body {background-color: ".concat(this.state.color,"; }"))),this.state.hasImageToDisplay&&i.a.createElement("img",{width:window.innerWidth,src:this.state.toDisplay,alt:""}),this.state.isCounting&&i.a.createElement("h1",null,this.state.seconds),i.a.createElement("canvas",{ref:this.canvas,width:this.state.browserDimensions[0],height:this.state.browserDimensions[1]}),this.state.isCounting&&i.a.createElement("div",null,this.state.seconds))}}]),e}(i.a.Component),x=(a(104),a(25)),W=a.n(x),q=(a(105),a(55)),F=a.n(q),H=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(h.a)(e).call(this))).state={users:[],angle:"",todoMessage:"Press start when all slaves are connected.",showCamera:!1,pictureToDisplay:"",displayMessage:""},t.masterChannel=b()("/masterChannel"),t.start=t.start.bind(Object(w.a)(t)),t.getTimeDiffs=t.getTimeDiffs.bind(Object(w.a)(t)),t.triangulate=t.triangulate.bind(Object(w.a)(t)),t.displayImage=t.displayImage.bind(Object(w.a)(t)),t.displayAnimation=t.displayAnimation.bind(Object(w.a)(t)),t}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.masterChannel.on("updateUsers",(function(e){var a="",n=!0,i=!1,s=void 0;try{for(var o,r=e[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){var l=o.value;a=a+l.id+": "+JSON.stringify(l.topRight)+", "}}catch(c){i=!0,s=c}finally{try{n||null==r.return||r.return()}finally{if(i)throw s}}t.setState({users:e,displayMessage:a})})),this.masterChannel.on("screensWhite",(function(){t.setState({todoMessage:"Please take a picture with all white screens in it"})})),this.masterChannel.on("nextScreen",(function(){t.setState({todoMessage:"If the next screen is red, please take a picture"})})),this.masterChannel.on("gotAllPics",(function(){t.setState({showCamera:!1,todoMessage:"All pictures have been taken"})})),this.masterChannel.on("resetRecognition",(function(){t.setState({showCamera:!1,todoMessage:"A slave disconnected, please start again."})}))}},{key:"onTakePhoto",value:function(t){this.masterChannel.emit("picture",t),console.log(t)}},{key:"start",value:function(){this.setState({showCamera:!0}),this.masterChannel.emit("startPictures")}},{key:"getTimeDiffs",value:function(){this.masterChannel.emit("getTimeDiffs")}},{key:"triangulate",value:function(){this.masterChannel.emit("DisplayTriangulation")}},{key:"triangulateTemplates",value:function(){this.masterChannel.emit("DisplayTemplateTriangulation")}},{key:"getFiles",value:function(t){this.setState({pictureToDisplay:t})}},{key:"displayImage",value:function(){var t=this.state.pictureToDisplay.base64;this.masterChannel.emit("DisplayImage",t)}},{key:"displayAnimation",value:function(){this.masterChannel.emit("DisplayAnimation")}},{key:"render",value:function(){var t=this;return i.a.createElement("div",null,i.a.createElement("button",{onClick:this.start},"Start"),i.a.createElement("h1",null,this.state.todoMessage),i.a.createElement("div",{className:"content"},this.state.showCamera&&i.a.createElement(W.a,{onTakePhoto:function(e){t.onTakePhoto(e)},idealFacingMode:x.FACING_MODES.ENVIRONMENT,isImageMirror:!1})),i.a.createElement("button",{onClick:this.getTimeDiffs},"Start countdown"),i.a.createElement("button",{onClick:this.triangulate},"Triangulate"),i.a.createElement("button",{onClick:this.displayImage},"Display Image"),i.a.createElement("button",{onClick:this.displayAnimation},"Animate"),i.a.createElement(F.a,{multiple:!1,onDone:this.getFiles.bind(this)}),this.state.displayMessage)}}]),e}(i.a.Component),N=a(56),R=a.n(N).a.create("penocw04.student.cs.kuleuven.be"),J=a(57),U=a.n(J),B=(a(122),function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(h.a)(e).call(this))).master=t.master.bind(Object(w.a)(t)),t.slave=t.slave.bind(Object(w.a)(t)),t.overview=t.overview.bind(Object(w.a)(t)),t.state={toMaster:!1,toSlave:!1,toOverview:!1,masterOccupied:!1},t.loginChannel=b()("/loginChannel"),t.masterOccupied=!0,t.loginChannel.on("master occupation state",(function(e){t.setState({masterOccupied:e})})),R.get("/login").then((function(t){})),t}return Object(u.a)(e,t),Object(l.a)(e,[{key:"master",value:function(){this.state.masterOccupied||this.setState({toMaster:!0})}},{key:"slave",value:function(){this.setState({toSlave:!0,toOverview:!1})}},{key:"overview",value:function(){this.setState({toOverview:!0,toSlave:!1})}},{key:"render",value:function(){return!0===this.state.toMaster?i.a.createElement(m.b,{to:"/master"}):!0===this.state.toSlave?i.a.createElement(m.b,{to:"/slave"}):!0===this.state.toOverview?i.a.createElement(m.b,{to:"/overview"}):i.a.createElement("div",null,i.a.createElement(y.a,null,i.a.createElement("style",null,"body { background-color: #032F64; }")),i.a.createElement("h1",null,"Multicat"),i.a.createElement("img",{className:"center",src:U.a,alt:""}),i.a.createElement("div",null,i.a.createElement("button",{name:"master",onClick:this.master},"Master"),i.a.createElement("button",{name:"slave",onClick:this.slave},"Slave"),i.a.createElement("button",{name:"overview",onClick:this.overview},"Overview")),this.state.masterOccupied&&i.a.createElement("h2",null,"Master has been occupied"))}}]),e}(i.a.Component)),G=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(c.a)(this,Object(h.a)(e).call(this))).overviewChannel=b()("/overviewChannel"),t.state={canvasDataToDisplay:"",canvasWidth:"",canvasHeight:"",browserDimensions:[window.innerWidth,window.innerHeight]},t.canvas=i.a.createRef(),t}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.overviewChannel.on("overviewUpdate",(function(e){t.setState({users:e.users})})),this.overviewChannel.on("setCanvas",(function(e,a,n){t.setState({canvasDataToDisplay:e,canvasWidth:a,canvasHeight:n})}))}},{key:"componentDidUpdate",value:function(){this.drawCanvas()}},{key:"drawCanvas",value:function(){var t=this.canvas.current,e=this.state.canvasDataToDisplay,a=t.getContext("2d"),n=this.state.browserDimensions[0],i=this.state.browserDimensions[1];if(a.clearRect(0,0,n,i),e){var s=this.state.canvasWidth,o=this.state.canvasHeight,r=n/s,l=i/o,c=Math.min(r,l),h=new Image;h.onload=function(){a.drawImage(h,0,0,s,o,0,0,c*s,c*o)},h.src=e}}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("canvas",{ref:this.canvas,width:this.state.browserDimensions[0],height:this.state.browserDimensions[1]}))}}]),e}(i.a.Component),V=function(t){function e(){return Object(r.a)(this,e),Object(c.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return i.a.createElement("main",null,i.a.createElement(m.a,null,i.a.createElement(m.d,null,i.a.createElement(m.c,{exact:!0,path:"/",component:B}),i.a.createElement(m.c,{path:"/slave",component:A}),i.a.createElement(m.c,{path:"/master",component:H}),i.a.createElement(m.c,{path:"/overview",component:G}))))}}]),e}(i.a.Component);a(125),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},57:function(t,e,a){t.exports=a.p+"static/media/nyan.5da985f3.gif"},60:function(t,e,a){t.exports=a(126)},94:function(t,e){}},[[60,1,2]]]);
//# sourceMappingURL=main.449691d6.chunk.js.map